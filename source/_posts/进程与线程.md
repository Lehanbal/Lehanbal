---
title: 进程与线程
date: 2020-10-29 15:20:21
tags:
- 操作系统
- 进程
- 线程
categories:
- 操作系统
---

## 进程

在计算机操作系统中，**进程是资源分配的基本单位**，也是独立运行的基本单位。

### 程序的执行顺序

- 顺序性。程序规定顺序执行
- 封闭性。程序运行后执行结果不会受外界因素影响。
- 可再现性。程序重复执行会获得相同效果

### 程序的并发执行

- 间断性。
- 失去封闭性。程序执行并发的时候，共享资源，也就失去了封闭性。
- 不可再现性。因为失去了封闭性，资源共享，会导致程序执行的时候资源发生变化，受到外界因素的影响。

并发执行的失去封闭性和不可再现性是我们说不期望发生的，我们现在要消除这种情况。

### **进程的定义**

- 进程是程序在处理器上的一次执行过程。
- 进程是可以和别的进程并行执行的计算。
- 进程是程序在一个数据集合上的运行过程，是系统进行资源分配和调度的一个独立单位。
- 进程可定义为一个数据结构及能在其上进行操作的一个程序。
- 进程是一个程序关于某个数据集合在处理器上顺序执行所发生的活动。

### 进程的特征

- 动态性。进程是程序在处理器上的一次执行过程，所以是动态的。
- 并发性。多个进程同时存在于内存中，能在一段时间内同时运行。
- 独立性。进程是一个能独立运行的基本单位，也是系统进行资源分配和调度的独立单位。
- 异步性。进程以各自独立，不可预知的速度向前推进。
- 结构特征。每个进程都具备进程控制块（PCB）。每个进程都由程序段、数据段和一个进程控制块组成。

### **进程和程序的关系**

- 进程是动态的，程序是静态的。进程是程序的执行，每个进程包含了程序段和数据段以及PCB，而程序是有序代码的集合，无执行意义。
- 进程是暂时的，程序是永久的。进程是一个状态变化的过程，程序可以长久保存。
- 进程与程序组成不同。进程的组成包括程序段、数据段和进程控制块，程序则只是有序代码的集合。
- 通过多次执行，一个程序可以产生多个进程；通过调用关系，一个进程可以执行多个程序。进程可创建其他进程，而程序不能形成新的程序。
- 进程具有并行特性，程序没有。

### **进程的状态转化**（重点的重点）

5种状态：就绪状态，执行状态，阻塞状态，创建状态，结束状态。

- 就绪状态：进程以获得除了处理器以外的所有资源，一旦进程获得处理器资源，就会立马执行。
- 执行状态：当一个进程获得必要的资源并正在cpu上执行的时候，该程序所处的状态为执行状态。
- 阻塞状态：正在执行的程序，由于发生了某件事件而暂时无法执行下去，此时所处的状态成为阻塞状态。这个状态下，即使把处理器分配给该线程，也无法运行。
- 创建状态，进程正在被创建，尚未转到就绪状态。
- 结束状态：进程正在从系统中消失。

状态转换如下：

![进程状态转化](https://gitee.com/lehanbal/blog-image/raw/master/img/进程状态转化.png)

- 就绪->执行状态：一个进程被进程调度程序选中。
- 执行->阻塞状态：请求并等待某个事件发生。
- 执行->就绪状态：时间片用完或者在抢占式调度中有更高优先级的进程变为就绪状态。
- 阻塞->就绪状态。进程因为等待的某个条件发生而被唤醒。

## 线程

### 线程的概念

- 线程是进程内的一个执行单元，比进程更小。
- 线程是进程内的一个可调度实体。
- 线程是程序（或进程）中相对独立的一个控制流序列。
- 线程本身不能单独运行，只能包含在进程中，只能在进程中执行。

### 线程和进程的比较

- 调度：在传统操作系统中，拥有资源和独立调度的基本单位都是进程。而在引入线程的操作系统中，线程是独立调度的基本单位，进程是拥有资源的基本单位。在同一进程中，线程的切换不会引起进程的切换。在不同进程中线程切换，如同一个进程内的线程切换到另一个进程的线程中，会引起进程切换。
- 拥有资源：不论是传统操作系统还是设有线程的操作系统，进程都是拥有资源的基本单位，而线程不拥有系统资源，但线程可以访问其归属的进程的系统资源，
- 并发性：进程之间可以并发执行，而同一进程内的多个线程之间也可以并发执行。这使得操作系统具有更好的并发性，大大提高了系统的吞吐量。
- 系统开销：进程开销很大，线程开销很小。

### **进程通信**

- 共享存储器系统

  为了传输大量数据，在存储器中划出一大块共享存储区，多个进程可以通过对共享存储区进行读写来实现通信。在通信前，进程向系统申请建立一个共享存储区，并指定该共享存储区的关键字。若该共享存储区已经建立，则将该共享存储区的描述符返回给申请者。然后，申请者把获得的共享存储区附接到进程上。这样，进程便可以像读写普通寄存器一样读写共享存储区了。

- 消息传递系统

  进程间以消息为单位交换数据，用户直接利用系统提供的一组通信命令来实现通信。操作系统隐藏了同行的实现细节，简化了通信程序，得到了广泛应用。根据实现方式不同，消息传递系统可以分为以下两类：

  1. 直接通信方式：发送进程直接把消息发送给接收进程，并将它挂在接收进程的消息缓冲队列上，接收进程从消息缓冲队列中获取消息。
  2. 间接通信方式。发送进程把消息发送到某个中间实体中，接收进程从中取得消息。

- 管道通信系统

  管道是用于连接读取进程和写进程以实现它们之间通信的共享文件。向管道提供输入的发送进程以字符流形式将大量的数据送入管道，而接受管道输出的进程可以从管道中接收数据。